<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PTZ Camera Control</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: system-ui, -apple-system, sans-serif;
      background-color: #0f172a;
      color: #e2e8f0;
      padding: 20px;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
    }

    h1 {
      font-size: 32px;
      font-weight: bold;
      margin-bottom: 30px;
      text-align: center;
      color: #06b6d4;
    }

    .grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 30px;
      margin-bottom: 30px;
    }

    .section {
      background-color: #1e293b;
      border-radius: 8px;
      padding: 20px;
      border: 1px solid #334155;
    }

    .section h2 {
      font-size: 20px;
      font-weight: bold;
      margin-bottom: 15px;
      color: #06b6d4;
    }

    .video-box {
      background-color: #0f172a;
      border-radius: 8px;
      overflow: hidden;
      margin-bottom: 15px;
      border: 2px solid #334155;
      aspect-ratio: 16 / 9;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 14px;
      color: #64748b;
    }

    video {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .url-input {
      margin-bottom: 15px;
    }

    label {
      display: block;
      margin-bottom: 5px;
      font-size: 12px;
      color: #94a3b8;
      font-weight: bold;
    }

    input {
      width: 100%;
      padding: 8px 12px;
      background-color: #0f172a;
      border: 1px solid #334155;
      border-radius: 4px;
      color: #e2e8f0;
      margin-bottom: 10px;
      font-size: 13px;
    }

    button {
      width: 100%;
      background-color: #06b6d4;
      color: #0f172a;
      padding: 8px 16px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-weight: bold;
      transition: all 0.2s;
    }

    button:hover {
      background-color: #00d9ff;
    }

    .joystick-container {
      margin-bottom: 20px;
      text-align: center;
    }

    #joystick {
      width: 200px;
      height: 200px;
      margin: 0 auto 15px;
      background-color: #0f172a;
      border: 3px solid #06b6d4;
      border-radius: 50%;
      cursor: grab;
      position: relative;
      display: flex;
      align-items: center;
      justify-content: center;
      user-select: none;
      box-shadow: 0 0 20px rgba(6, 182, 212, 0.3);
    }

    #joystick:active {
      cursor: grabbing;
      box-shadow: 0 0 30px rgba(6, 182, 212, 0.6);
    }

    #joystickKnob {
      width: 50px;
      height: 50px;
      background-color: #06b6d4;
      border: 2px solid #00d9ff;
      border-radius: 50%;
      position: absolute;
      box-shadow: 0 0 15px rgba(6, 182, 212, 0.8);
      left: 75px;
      top: 75px;
      transition: all 0.05s ease;
    }

    .joystick-center {
      position: absolute;
      width: 2px;
      height: 2px;
      background-color: #06b6d4;
      border-radius: 50%;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 10;
    }

    .joystick-crosshair-h {
      position: absolute;
      width: 30px;
      height: 1px;
      background-color: rgba(6, 182, 212, 0.2);
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 1;
    }

    .joystick-crosshair-v {
      position: absolute;
      width: 1px;
      height: 30px;
      background-color: rgba(6, 182, 212, 0.2);
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 1;
    }

    .status-box {
      background-color: #0f172a;
      border: 1px solid #334155;
      border-radius: 4px;
      padding: 15px;
      margin-bottom: 15px;
    }

    .status-item {
      display: flex;
      justify-content: space-between;
      padding: 5px 0;
      font-size: 14px;
    }

    .status-label {
      color: #94a3b8;
      font-weight: bold;
    }

    .status-value {
      color: #06b6d4;
      font-family: monospace;
      font-weight: bold;
    }

    .button-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 8px;
    }

    .small-button {
      background-color: #334155 !important;
      color: #e2e8f0 !important;
      padding: 10px !important;
      border: 1px solid #475569 !important;
      font-size: 12px;
    }

    .small-button:hover {
      background-color: #475569 !important;
    }

    .info-box {
      background-color: #1e293b;
      border-radius: 8px;
      padding: 20px;
      border: 1px solid #334155;
    }

    .info-box h3 {
      font-size: 16px;
      font-weight: bold;
      margin-bottom: 10px;
      color: #06b6d4;
    }

    .info-box p {
      font-size: 13px;
      color: #cbd5e1;
      line-height: 1.8;
    }

    .info-box code {
      background-color: #0f172a;
      padding: 2px 6px;
      border-radius: 3px;
      font-family: monospace;
      font-size: 12px;
    }

    @media (max-width: 768px) {
      .grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üé¨ PTZ Camera Control</h1>

    <div class="grid">
      <!-- Left: Video -->
      <div class="section">
        <h2>üìπ Live Stream</h2>
        <div class="video-box" id="videoBox">
          <video id="videoPreview" autoplay muted controls></video>
        </div>
        <div class="url-input">
          <label>Stream URL:</label>
          <input
            id="streamUrl"
            type="text"
            value="rtsp://192.168.1.11/1/h264major"
            placeholder="Enter stream URL"
          />
          <button onclick="loadStream()">Load Stream</button>
        </div>
      </div>

      <!-- Right: Joystick & Controls -->
      <div class="section">
        <h2>üéÆ PTZ Control</h2>

        <div class="joystick-container">
          <div id="joystick">
            <div class="joystick-crosshair-h"></div>
            <div class="joystick-crosshair-v"></div>
            <div id="joystickKnob"></div>
            <div class="joystick-center"></div>
          </div>
        </div>

        <div class="status-box">
          <div class="status-item">
            <span class="status-label">Pan:</span>
            <span class="status-value" id="panValue">0.00¬∞</span>
          </div>
          <div class="status-item">
            <span class="status-label">Tilt:</span>
            <span class="status-value" id="tiltValue">0.00¬∞</span>
          </div>
          <div class="status-item">
            <span class="status-label">Zoom:</span>
            <span class="status-value" id="zoomValue">1.0x</span>
          </div>
        </div>

        <div class="button-grid">
          <button class="small-button" onclick="sendPTZ('left')">‚Üê Pan Left</button>
          <button class="small-button" onclick="sendPTZ('up')">‚Üë Tilt Up</button>
          <button class="small-button" onclick="sendPTZ('right')">Pan Right ‚Üí</button>
          <button class="small-button" onclick="sendPTZ('down')">‚Üì Tilt Down</button>
          <button class="small-button" onclick="sendPTZ('zoomin')">üîç Zoom In</button>
          <button class="small-button" onclick="sendPTZ('zoomout')">üîç Zoom Out</button>
          <button class="small-button" onclick="sendPTZ('home')">‚åñ Home</button>
          <button class="small-button" onclick="sendPTZ('focus')">‚óØ Auto Focus</button>
        </div>
      </div>
    </div>

    <div class="info-box">
      <h3>‚ÑπÔ∏è Camera Information</h3>
      <p><strong>IP:</strong> <code>192.168.1.11:81</code></p>
      <p><strong>RTSP Stream:</strong> <code>rtsp://192.168.1.11/1/h264major</code></p>
      <p><strong>HTTP Control:</strong> <code>http://192.168.1.11:81/cgi-bin/</code></p>
    </div>
  </div>

  <script>
    let panPos = 0;
    let tiltPos = 0;
    let zoomLevel = 1.0;
    let isDragging = false;

    const joystick = document.getElementById('joystick');
    const knob = document.getElementById('joystickKnob');
    const maxDistance = 75;

    function updateDisplay() {
      document.getElementById('panValue').textContent = (panPos * 100).toFixed(1) + '¬∞';
      document.getElementById('tiltValue').textContent = (tiltPos * 100).toFixed(1) + '¬∞';
      document.getElementById('zoomValue').textContent = zoomLevel.toFixed(1) + 'x';
    }

    joystick.addEventListener('mousedown', (e) => {
      isDragging = true;
      updateKnobPosition(e);
    });

    document.addEventListener('mousemove', (e) => {
      if (isDragging) updateKnobPosition(e);
    });

    document.addEventListener('mouseup', () => {
      isDragging = false;
      panPos = 0;
      tiltPos = 0;
      knob.style.left = '75px';
      knob.style.top = '75px';
      updateDisplay();
    });

    function updateKnobPosition(e) {
      const rect = joystick.getBoundingClientRect();
      const centerX = rect.left + rect.width / 2;
      const centerY = rect.top + rect.height / 2;

      let x = e.clientX - centerX;
      let y = e.clientY - centerY;

      const distance = Math.sqrt(x * x + y * y);
      if (distance > maxDistance) {
        x = (x / distance) * maxDistance;
        y = (y / distance) * maxDistance;
      }

      knob.style.left = (100 + x) + 'px';
      knob.style.top = (100 + y) + 'px';

      panPos = x / maxDistance;
      tiltPos = -y / maxDistance;
      updateDisplay();
    }

    joystick.addEventListener('wheel', (e) => {
      e.preventDefault();
      zoomLevel += e.deltaY > 0 ? -0.1 : 0.1;
      zoomLevel = Math.max(1.0, Math.min(10.0, zoomLevel));
      updateDisplay();
    });

    function loadStream() {
      const url = document.getElementById('streamUrl').value;
      console.log('Load stream:', url);
      // TODO: Integrate with backend streaming
    }

    function sendPTZ(command) {
      console.log('PTZ Command:', command);
      // TODO: Integrate with camera HTTP API
    }

    updateDisplay();
  </script>
</body>
</html>
